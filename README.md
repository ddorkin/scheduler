## Installation

```bash
$ npm install
```

## Running the app

```bash
# set up redis and postgres envs
$ cd ./docker
$ docker-compose up
$ cd ..

# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```

## Краткая справка
* Логика реализована в расчёте на то, что у нас один инстанс редиса, если же их несколько, то стоит посмотреть в сторону redlock
* По коду должно быть понятно, какая идея реализована. Но если нет, читаем дальше

1. получить список всех джоб из базы данных
2. проверить, если ли локально уже список этих джоб
3. если есть, то проверить дифф, если дифф есть, то обновить джобы (в дальнейшем можно обновить только сам дифф)
4. если списка нет, то создаем крон-джобы

далее, когда выполняется крона
1. Сначала проверяем, что она не находится в редисе по айдишнику
2. Если находится, значит пропускаем выполнение
3. Иначе выставляем значение в редисе (блокируем выполнение другими инстансами по айдишнику),
   причём выставляем ttl на одну минуту (время ожидания запроса), если сервис отвалится, то что поделать
4. Выполняем джобу
5. Снимаем блокировку с редиса

## Что можно поулучшать:
1. переделать внутренний массив с джобами под Set
2. если что можно сделать config.service.ts (для того, чтобы брать настройки для баз данных, чтобы это было комильфо)
3. на создание, изменение и удаление можно фаерить эвенты, чтобы вызывать обновления джоб, но это будет нифига не персистентно, потому что много инстансов (но как отправная точка для мыслей на будущее)
